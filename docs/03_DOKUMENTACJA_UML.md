# 3. Dokumentacja UML - System WspomagajÄ…cy TerapiÄ™ PsychologicznÄ…

## 3.1 Wprowadzenie

Niniejszy dokument zawiera kompletnÄ… dokumentacjÄ™ UML systemu wspomagajÄ…cego terapiÄ™ psychologicznÄ…. Diagramy przedstawiajÄ… architekturÄ™ systemu, przepÅ‚yw danych oraz interakcje miÄ™dzy komponentami.

## 3.2 Diagram PrzypadkÃ³w UÅ¼ycia (Use Case Diagram)

```
                    System WspomagajÄ…cy TerapiÄ™ PsychologicznÄ…
    
    Pacjent                                                    Terapeuta
       |                                                          |
       |-- Rejestracja                                            |-- Logowanie
       |-- Logowanie                                              |-- PrzeglÄ…danie pacjentÃ³w
       |-- ZarzÄ…dzanie dziennikiem nastroju                      |-- PrzeglÄ…d dziennikÃ³w nastroju
       |    |-- Dodawanie wpisu nastroju                         |-- PrzeglÄ…d lekÃ³w pacjentÃ³w  
       |    |-- Edycja wpisu nastroju                            |-- WysyÅ‚anie wiadomoÅ›ci
       |    |-- Usuwanie wpisu nastroju                          |-- Odbieranie wiadomoÅ›ci
       |    |-- PrzeglÄ…danie historii                            |-- PrzeglÄ…danie powiadomieÅ„
       |-- ZarzÄ…dzanie lekami                                    |-- Analiza statystyk pacjenta
       |    |-- Dodawanie leku                                   |
       |    |-- Edycja leku                                      |
       |    |-- Oznaczanie jako aktywny/nieaktywny               |
       |-- Komunikacja z terapeutÄ…                               |
       |    |-- WysyÅ‚anie wiadomoÅ›ci                             |
       |    |-- Odbieranie wiadomoÅ›ci                            |
       |-- PrzeglÄ…danie powiadomieÅ„                              |
       |-- PrzeglÄ…danie statystyk wÅ‚asnych                       |
       
                                |
                        Administrator Systemu
                                |
                                |-- ZarzÄ…dzanie uÅ¼ytkownikami
                                |-- Tworzenie relacji terapeuta-pacjent
                                |-- Monitoring systemu
                                |-- ZarzÄ…dzanie backupami
```

## 3.3 Diagram Klas (Class Diagram)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     User        â”‚       â”‚  TherapistPatient â”‚       â”‚   MoodEntry     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + id: int       â”‚â—„â”€â”€â”€â”€â”€â”€â”¤ + id: int        â”‚       â”‚ + id: int       â”‚
â”‚ + email: string â”‚       â”‚ + therapist_id:intâ”‚       â”‚ + user_id: int  â”‚
â”‚ + password: hashâ”‚       â”‚ + patient_id: int â”‚       â”‚ + mood_rating:intâ”‚
â”‚ + first_name: strâ”‚      â”‚ + created_at: dateâ”‚       â”‚ + notes: text   â”‚
â”‚ + last_name: strâ”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ + entry_date:dateâ”‚
â”‚ + role: enum    â”‚                                   â”‚ + created_at:dateâ”‚
â”‚ + created_at:dateâ”‚                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                           â”‚
â”‚ + register()    â”‚                                           â”‚
â”‚ + login()       â”‚                                           â”‚
â”‚ + logout()      â”‚                                           â”‚
â”‚ + updateProfile()â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                          â”‚
         â”‚                                                    â”‚
         â”‚                                                    â”‚
         â”‚1                                                   â”‚*
         â”‚                                                    â”‚
         â–¼                                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Medication    â”‚       â”‚     Message      â”‚       â”‚  Notification   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + id: int       â”‚       â”‚ + id: int        â”‚       â”‚ + id: int       â”‚
â”‚ + user_id: int  â”‚       â”‚ + sender_id: int â”‚       â”‚ + user_id: int  â”‚
â”‚ + name: string  â”‚       â”‚ + recipient_id:intâ”‚       â”‚ + type: string  â”‚
â”‚ + dosage: stringâ”‚       â”‚ + content: text  â”‚       â”‚ + message: text â”‚
â”‚ + frequency: strâ”‚       â”‚ + is_read: bool  â”‚       â”‚ + is_read: bool â”‚
â”‚ + time_slots:jsonâ”‚      â”‚ + created_at:dateâ”‚       â”‚ + created_at:dateâ”‚
â”‚ + active: bool  â”‚       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + created_at:dateâ”‚      â”‚ + send()         â”‚       â”‚ + create()      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚ + markAsRead()   â”‚       â”‚ + markAsRead()  â”‚
â”‚ + add()         â”‚       â”‚ + getHistory()   â”‚       â”‚ + getUnread()   â”‚
â”‚ + update()      â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ + delete()      â”‚
â”‚ + toggleActive()â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Relationships:
- User (1) â†â†’ (*) MoodEntry
- User (1) â†â†’ (*) Medication  
- User (1) â†â†’ (*) Message (as sender)
- User (1) â†â†’ (*) Message (as recipient)
- User (1) â†â†’ (*) Notification
- User (*) â†â†’ (*) User (through TherapistPatient)
```

## 3.4 Diagram Sekwencji - Logowanie UÅ¼ytkownika

```
Client          Frontend        AuthService     Database        JWT Service
  |               |               |               |               |
  |-- login() --->|               |               |               |
  |               |-- POST /api/auth/login ----->|               |
  |               |               |-- validateCredentials() ---->|
  |               |               |               |-- query() -->|
  |               |               |               |<-- result ---|
  |               |               |<-- user ------|               |
  |               |               |-- generateToken() --------->|
  |               |               |<-- token -----------------|
  |               |<-- 200 + token + user data ---|               |
  |<-- success ---|               |               |               |
  |               |-- setAuthHeader() ----------->|               |
  |               |-- saveToLocalStorage() ------>|               |
  |               |-- redirectToDashboard() ----->|               |
```

## 3.5 Diagram Sekwencji - Dodawanie Wpisu Nastroju

```
Patient     Frontend     MoodService     Validation     Database     NotificationService
  |           |             |               |             |               |
  |-- addMoodEntry() ----->|               |             |               |
  |           |-- POST /api/mood --------->|               |             |
  |           |             |-- validate() ------>|       |               |
  |           |             |<-- valid ----------|       |               |
  |           |             |-- authenticateUser() ----->|               |
  |           |             |<-- user -----------|       |               |
  |           |             |-- insert() ----------------->|               |
  |           |             |<-- moodEntry --------------|               |
  |           |             |-- createNotification() ------------------------>|
  |           |             |<-- notification ---------------------------|
  |           |<-- 201 + moodEntry data ---|             |               |
  |<-- success|             |               |             |               |
```

## 3.6 Diagram AktywnoÅ›ci - Proces Komunikacji Terapeuta-Pacjent

```
                        Start
                          |
                          â–¼
                [Terapeuta loguje siÄ™]
                          |
                          â–¼
                [Wybiera pacjenta z listy]
                          |
                          â–¼
                [Sprawdza czy istnieje relacja] â”€â”€Noâ”€â”€â–º [Error: Brak uprawnieÅ„]
                          |                                        |
                         Yes                                       â–¼
                          â–¼                                      End
                [Pisze wiadomoÅ›Ä‡]
                          |
                          â–¼
                [Walidacja treÅ›ci] â”€â”€Invalidâ”€â”€â–º [Pokazuje bÅ‚Ä…d walidacji]
                          |                             |
                         Valid                          â–¼
                          â–¼                    [Poprawia wiadomoÅ›Ä‡]
                [Zapisuje w bazie danych]               |
                          |                             |
                          â–¼                             |
                [Tworzy powiadomienie dla pacjenta] â”€â”€â”€â”€â”˜
                          |
                          â–¼
                [Pacjent otrzymuje powiadomienie]
                          |
                          â–¼
                [Pacjent czyta wiadomoÅ›Ä‡]
                          |
                          â–¼
            [Pacjent moÅ¼e odpowiedzieÄ‡] â”€â”€Noâ”€â”€â–º End
                          |                      
                         Yes                     
                          â–¼                      
                [Proces powtarza siÄ™ w drugÄ… stronÄ™]
                          |
                          â–¼
                        End
```

## 3.7 Diagram StanÃ³w - Cykl Å»ycia Wpisu Nastroju

```
                    [Created]
                        |
                        | add()
                        â–¼
                   [Pending Validation]
                        |
              validate() |
                        â–¼
        Invalid â—„â”€â”€ [Validation] â”€â”€â–º Valid
           |                           |
           â–¼                           â–¼
      [Rejected]                   [Active]
           |                           |
           |                           | edit()
           |                           â–¼
           |                    [Being Edited]
           |                           |
           |                    update() |
           |                           â–¼
           |                      [Active]
           |                           |
           |                    delete() |
           |                           â–¼
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º [Deleted]
                                      |
                                      â–¼
                               [Soft Deleted]
                                      |
                              purge() |
                                      â–¼
                              [Permanently Deleted]
```

## 3.8 Diagram KomponentÃ³w - Architektura Systemu

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Frontend (React)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Components    â”‚     Contexts      â”‚         Pages             â”‚
â”‚                 â”‚                   â”‚                           â”‚
â”‚ â€¢ Layout        â”‚ â€¢ AuthContext     â”‚ â€¢ Login/Register          â”‚
â”‚ â€¢ ProtectedRouteâ”‚ â€¢ NotificationCtx â”‚ â€¢ Dashboard               â”‚
â”‚                 â”‚                   â”‚ â€¢ MoodDiary               â”‚
â”‚                 â”‚                   â”‚ â€¢ Medications             â”‚
â”‚                 â”‚                   â”‚ â€¢ Messages                â”‚
â”‚                 â”‚                   â”‚ â€¢ Patients                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                           HTTP/HTTPS
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Backend (Express.js)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     Routes      â”‚    Middleware     â”‚        Services           â”‚
â”‚                 â”‚                   â”‚                           â”‚
â”‚ â€¢ /auth         â”‚ â€¢ Authentication  â”‚ â€¢ UserService             â”‚
â”‚ â€¢ /mood         â”‚ â€¢ Validation      â”‚ â€¢ MoodService             â”‚
â”‚ â€¢ /medication   â”‚ â€¢ Error Handling  â”‚ â€¢ MedicationService       â”‚
â”‚ â€¢ /messages     â”‚ â€¢ CORS            â”‚ â€¢ MessageService          â”‚
â”‚ â€¢ /notificationsâ”‚ â€¢ Rate Limiting   â”‚ â€¢ NotificationService     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                            SQL Queries
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Database (PostgreSQL)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     Tables      â”‚     Indexes       â”‚        Constraints        â”‚
â”‚                 â”‚                   â”‚                           â”‚
â”‚ â€¢ users         â”‚ â€¢ user_email_idx  â”‚ â€¢ FK user_id              â”‚
â”‚ â€¢ mood_entries  â”‚ â€¢ mood_date_idx   â”‚ â€¢ FK therapist_id         â”‚
â”‚ â€¢ medications   â”‚ â€¢ med_user_idx    â”‚ â€¢ FK patient_id           â”‚
â”‚ â€¢ messages      â”‚ â€¢ msg_users_idx   â”‚ â€¢ CHECK mood_rating 1-10  â”‚
â”‚ â€¢ notifications â”‚ â€¢ notif_user_idx  â”‚ â€¢ UNIQUE email            â”‚
â”‚ â€¢ therapist_patients â”‚             â”‚                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 3.9 Diagram WdroÅ¼enia (Deployment Diagram)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Client Browser                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Chrome        â”‚  â”‚    Firefox      â”‚  â”‚     Safari      â”‚  â”‚
â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚
â”‚  â”‚ React App       â”‚  â”‚ React App       â”‚  â”‚ React App       â”‚  â”‚
â”‚  â”‚ (localhost:3000)â”‚  â”‚ (localhost:3000)â”‚  â”‚ (localhost:3000)â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                           HTTP/HTTPS
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Application Server                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                 Node.js Runtime                           â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚  â”‚
â”‚  â”‚  â”‚ Express Server  â”‚  â”‚ JWT Service     â”‚                â”‚  â”‚
â”‚  â”‚  â”‚ (Port 5000)     â”‚  â”‚                 â”‚                â”‚  â”‚
â”‚  â”‚  â”‚                 â”‚  â”‚                 â”‚                â”‚  â”‚
â”‚  â”‚  â”‚ â€¢ Auth Routes   â”‚  â”‚ â€¢ Token Gen     â”‚                â”‚  â”‚
â”‚  â”‚  â”‚ â€¢ API Routes    â”‚  â”‚ â€¢ Validation    â”‚                â”‚  â”‚
â”‚  â”‚  â”‚ â€¢ Middleware    â”‚  â”‚                 â”‚                â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                         TCP/IP (Port 5432)
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Database Server                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                PostgreSQL Database                       â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚  Database: therapy_support                               â”‚  â”‚
â”‚  â”‚  User: postgres                                          â”‚  â”‚
â”‚  â”‚  Host: localhost                                         â”‚  â”‚
â”‚  â”‚  Port: 5432                                              â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚  Tables:                                                 â”‚  â”‚
â”‚  â”‚  â€¢ users                                                 â”‚  â”‚
â”‚  â”‚  â€¢ mood_entries                                          â”‚  â”‚
â”‚  â”‚  â€¢ medications                                           â”‚  â”‚
â”‚  â”‚  â€¢ messages                                              â”‚  â”‚
â”‚  â”‚  â€¢ notifications                                         â”‚  â”‚
â”‚  â”‚  â€¢ therapist_patients                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 3.10 Diagram PakietÃ³w - Struktura Kodu

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         therapy-app                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚     client      â”‚                â”‚     server      â”‚          â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚          â”‚
â”‚  â”‚ â”‚     src     â”‚ â”‚                â”‚ â”‚   routes    â”‚ â”‚          â”‚
â”‚  â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚                â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚          â”‚
â”‚  â”‚ â”‚ â€¢ componentsâ”‚ â”‚                â”‚ â”‚ â€¢ auth.js   â”‚ â”‚          â”‚
â”‚  â”‚ â”‚ â€¢ pages     â”‚ â”‚                â”‚ â”‚ â€¢ mood.js   â”‚ â”‚          â”‚
â”‚  â”‚ â”‚ â€¢ contexts  â”‚ â”‚                â”‚ â”‚ â€¢ medicationâ”‚ â”‚          â”‚
â”‚  â”‚ â”‚ â€¢ assets    â”‚ â”‚                â”‚ â”‚ â€¢ messages  â”‚ â”‚          â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                â”‚ â”‚ â€¢ notifications â”‚ â”‚        â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚          â”‚
â”‚  â”‚ â”‚   public    â”‚ â”‚                â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚          â”‚
â”‚  â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚                â”‚ â”‚   config    â”‚ â”‚          â”‚
â”‚  â”‚ â”‚ â€¢ index.htmlâ”‚ â”‚                â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚          â”‚
â”‚  â”‚ â”‚ â€¢ vite.svg  â”‚ â”‚                â”‚ â”‚ â€¢ database  â”‚ â”‚          â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚          â”‚
â”‚  â”‚ â€¢ package.json  â”‚                â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚          â”‚
â”‚  â”‚ â€¢ vite.config   â”‚                â”‚ â”‚ middleware  â”‚ â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚          â”‚
â”‚                                     â”‚ â”‚ â€¢ auth.js   â”‚ â”‚          â”‚
â”‚                                     â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚          â”‚
â”‚                                     â”‚ â€¢ index.js      â”‚          â”‚
â”‚                                     â”‚ â€¢ package.json  â”‚          â”‚
â”‚                                     â”‚ â€¢ .env          â”‚          â”‚
â”‚                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                             â”‚
â”‚  â”‚      docs       â”‚                                             â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                             â”‚
â”‚  â”‚ â€¢ README.md     â”‚                                             â”‚
â”‚  â”‚ â€¢ UML_DOCS.md   â”‚                                             â”‚
â”‚  â”‚ â€¢ REQUIREMENTS  â”‚                                             â”‚
â”‚  â”‚ â€¢ TESTING.md    â”‚                                             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 3.11 Diagram Komunikacji - PrzepÅ‚yw Danych

```
Browser                 React App              Express API           Database
   â”‚                       â”‚                       â”‚                    â”‚
   â”‚â”€â”€ HTTP Request â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                       â”‚                    â”‚
   â”‚                       â”‚â”€â”€ API Call â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                    â”‚
   â”‚                       â”‚   (axios)              â”‚                    â”‚
   â”‚                       â”‚                       â”‚â”€â”€ SQL Query â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
   â”‚                       â”‚                       â”‚                    â”‚
   â”‚                       â”‚                       â”‚â—„â”€â”€ Result Set â”€â”€â”€â”€â”€â”‚
   â”‚                       â”‚â—„â”€â”€ JSON Response â”€â”€â”€â”€â”€â”‚                    â”‚
   â”‚â—„â”€â”€ DOM Update â”€â”€â”€â”€â”€â”€â”€â”€â”‚                       â”‚                    â”‚
   â”‚                       â”‚                       â”‚                    â”‚
   â”‚                       â”‚                       â”‚                    â”‚
   â”‚        WebSocket       â”‚      WebSocket        â”‚    Database        â”‚
   â”‚     (for future)       â”‚    (for real-time)    â”‚   Triggers         â”‚
   â”‚â—„â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€â”€â”‚â—„â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€â”€â”‚â—„â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€â”‚
   â”‚   Push Notifications   â”‚    Event Handling     â”‚   Change Events    â”‚

Authentication Flow:
Browser â”€â”€loginâ”€â”€â–º React â”€â”€POST /auth/loginâ”€â”€â–º Express â”€â”€validateâ”€â”€â–º Database
Browser â—„â”€tokenâ”€â”€â”€â”‚ React â—„â”€JWT tokenâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ Express â—„â”€userâ”€â”€â”€â”€â”€â”‚ Database
Browser â”€â”€authâ”€â”€â”€â”€â–º React â”€â”€Authorizationâ”€â”€â”€â”€â”€â–º Express â”€â”€verifyâ”€â”€â”€â–º Database
        header           header                         JWT
```

## 3.12 Diagram ERD - Model Danych

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      users      â”‚         â”‚ therapist_patientsâ”‚         â”‚   mood_entries  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ðŸ”‘ id (PK)      â”‚â—„â”€â”€â”€â”    â”‚ ðŸ”‘ id (PK)       â”‚    â”Œâ”€â”€â”€â–ºâ”‚ ðŸ”‘ id (PK)      â”‚
â”‚ ðŸ”’ email (UQ)   â”‚    â”‚    â”‚ ðŸ”— therapist_id  â”‚    â”‚    â”‚ ðŸ”— user_id (FK) â”‚
â”‚   password      â”‚    â”‚    â”‚    (FK)          â”‚    â”‚    â”‚   mood_rating   â”‚
â”‚   first_name    â”‚    â”‚    â”‚ ðŸ”— patient_id    â”‚    â”‚    â”‚   notes         â”‚
â”‚   last_name     â”‚    â”‚    â”‚    (FK)          â”‚    â”‚    â”‚   entry_date    â”‚
â”‚   role          â”‚    â”‚    â”‚   created_at     â”‚    â”‚    â”‚   created_at    â”‚
â”‚   created_at    â”‚    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚              â”‚             â”‚
         â”‚              â”‚              â”‚             â”‚
         â”‚              â”‚              â”‚             â”‚
         â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                             â”‚
         â”‚                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   medications   â”‚                    â”‚         â”‚    messages     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ðŸ”‘ id (PK)      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”Œâ”€â”€â”€â–ºâ”‚ ðŸ”‘ id (PK)      â”‚
â”‚ ðŸ”— user_id (FK) â”‚                         â”‚    â”‚ ðŸ”— sender_id    â”‚
â”‚   name          â”‚                         â”‚    â”‚    (FK)         â”‚
â”‚   dosage        â”‚                         â”‚    â”‚ ðŸ”— recipient_id â”‚
â”‚   frequency     â”‚                         â”‚    â”‚    (FK)         â”‚
â”‚   time_slots    â”‚                         â”‚    â”‚   content       â”‚
â”‚   active        â”‚                         â”‚    â”‚   is_read       â”‚
â”‚   created_at    â”‚                         â”‚    â”‚   created_at    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â”‚
                                            â”‚
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚ notifications   â”‚
                              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                              â”‚ ðŸ”‘ id (PK)      â”‚
                              â”‚ ðŸ”— user_id (FK) â”‚â—„â”€â”€â”€â”˜
                              â”‚   type          â”‚
                              â”‚   message       â”‚
                              â”‚   is_read       â”‚
                              â”‚   created_at    â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Relationships:
â€¢ users (1) â†â†’ (*) mood_entries
â€¢ users (1) â†â†’ (*) medications
â€¢ users (1) â†â†’ (*) messages (as sender)
â€¢ users (1) â†â†’ (*) messages (as recipient)
â€¢ users (1) â†â†’ (*) notifications
â€¢ users (*) â†â†’ (*) users (through therapist_patients)

Constraints:
â€¢ mood_rating: CHECK (mood_rating >= 1 AND mood_rating <= 10)
â€¢ role: CHECK (role IN ('patient', 'therapist'))
â€¢ email: UNIQUE, NOT NULL
â€¢ All FKs: ON DELETE CASCADE
```

## 3.13 Podsumowanie Architektury

### 3.13.1 Kluczowe Wzorce Projektowe:
- **MVC (Model-View-Controller)**: Separacja logiki biznesowej od prezentacji
- **Repository Pattern**: Abstrakcja dostÄ™pu do danych
- **Middleware Pattern**: Przetwarzanie Å¼Ä…daÅ„ HTTP
- **Observer Pattern**: System powiadomieÅ„
- **Authentication/Authorization Pattern**: BezpieczeÅ„stwo systemu

### 3.13.2 Charakterystyka Architektury:
- **Architektura 3-warstwowa**: Prezentacja, Logika, Dane
- **RESTful API**: Standaryzowana komunikacja
- **Reactive Components**: React hooks i context
- **Database-First**: PostgreSQL jako gÅ‚Ã³wne ÅºrÃ³dÅ‚o prawdy
- **Stateless Backend**: JWT dla autoryzacji

### 3.13.3 Zalety RozwiÄ…zania:
- âœ… **SkalowalnoÅ›Ä‡**: Åatwe dodawanie nowych funkcji
- âœ… **Maintainability**: Czysta separacja odpowiedzialnoÅ›ci  
- âœ… **Security**: Wielopoziomowe zabezpieczenia
- âœ… **Performance**: Optymalizowane zapytania i indeksy
- âœ… **Usability**: Intuicyjny interfejs uÅ¼ytkownika

---

*Dokument wersja 1.0*  
*Data ostatniej aktualizacji: Lipiec 2025*
